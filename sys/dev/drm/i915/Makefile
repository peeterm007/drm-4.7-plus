KMOD	= i915

# core driver code
SRCS =	i915_drv.c \
	i915_irq.c \
	i915_params.c \
	i915_suspend.c \
	i915_sysfs.c \
	intel_csr.c \
	intel_pm.c \
	intel_runtime_pm.c

# GEM code
SRCS +=	i915_cmd_parser.c \
	i915_gem_batch_pool.c \
	i915_gem_context.c \
	i915_gem_evict.c \
	i915_gem_execbuffer.c \
	i915_gem_fence.o \
	i915_gem_gtt.c \
	i915_gem.c \
	i915_gem_render_state.c \
	i915_gem_shrinker.c \
	i915_gem_stolen.c \
	i915_gem_tiling.c \
	i915_gem_userptr.c \
	i915_gpu_error.c \
	intel_lrc.c \
	intel_mocs.c \
	intel_ringbuffer.c \
	intel_uncore.c

# general-purpose microcontroller (GuC) support
SRCS += intel_guc_loader.c \
	i915_guc_submission.c

# autogenerated null render state
SRCS +=	intel_renderstate_gen6.c \
	intel_renderstate_gen7.c \
	intel_renderstate_gen8.c \
	intel_renderstate_gen9.c

# modesetting core code
SRCS += \
	intel_audio.c \
	intel_atomic.c \
	intel_atomic_plane.c \
	intel_acpi.c \
	intel_bios.c \
	intel_color.c \
	intel_display.c \
	intel_dpll_mgr.c \
	intel_fbc.c \
	intel_fifo_underrun.c \
	intel_frontbuffer.c \
	intel_hotplug.c \
	intel_fbdev.c \
	intel_modes.c \
	intel_opregion.c \
	intel_overlay.c \
	intel_psr.c \
	intel_sideband.c \
	intel_sprite.c

# modesetting output/encoder code
SRCS += \
	dvo_ch7017.c \
	dvo_ch7xxx.c \
	dvo_ivch.c \
	dvo_ns2501.c \
	dvo_sil164.c \
	dvo_tfp410.c \
	intel_crt.c \
	intel_ddi.c \
	intel_dp_link_training.c \
	intel_dp_mst.c \
	intel_dp.c \
	intel_dsi.c \
	intel_dsi_panel_vbt.c \
	intel_dsi_pll.c \
	intel_dvo.c \
	intel_hdmi.c \
	intel_i2c.c \
	intel_lvds.c \
	intel_panel.c \
	intel_sdvo.c \
	intel_tv.c

# virtual gpu code
SRCS += i915_vgpu.c

# legacy horrors
SRCS += i915_dma.c

SRCS   += acpi_if.h device_if.h bus_if.h pci_if.h iicbus_if.h iicbb_if.h \
	  opt_acpi.h opt_drm.h opt_ktr.h

KCFLAGS+= -I${SYSDIR}/dev/drm/include
KCFLAGS+= -I${SYSDIR}/contrib/dev/acpica/source/include
KCFLAGS+= -DCONFIG_BACKLIGHT_CLASS_DEVICE

.include <bsd.kmod.mk>
